# `src` 目录

## 目录概述

`src` (source) 目录是整个油猴脚本的源代码中心。它包含了构建最终可执行脚本所需的所有核心逻辑、配置文件、UI 模块和翻译数据。

此目录下的文件和子目录共同构成了一个模块化的、可维护的应用程序架构。

---

## 文件与子目录结构

-   **`main.js`**
    -   **职责**: **标准构建**的入口文件。
    -   **功能**: 负责加载所有模块和翻译数据，并根据当前环境（网站、用户语言）选择合适的词典，最终将所有部分打包成一个完整的、自包含的离线版脚本。

-   **`main-cdn.js`**
    -   **职责**: **CDN 构建**的入口文件。
    -   **功能**: 作为轻量级加载器，此脚本在运行时会动态地从 CDN 获取大部分翻译数据，只将少量核心网站的翻译嵌入其中，以减小初始脚本的体积。

-   **`header.txt` & `header-cdn.txt`**
    -   **职责**: 定义油猴脚本的元数据块 (`==UserScript==...`)。
    -   **功能**: 包含了脚本的名称、版本、描述、作者、匹配的网站 (`@match`) 以及所需的权限 (`@grant`) 等关键信息。`header.txt` 用于标准构建，而 `header-cdn.txt` 包含了针对 CDN 版本的特定配置。

-   **`/config`**
    -   **职责**: 存放项目的全局配置文件。
    -   **内容**: 定义了脚本的核心行为规则，如哪些 HTML 标签或属性应该被翻译，以及哪些网站在 CDN 构建模式下需要被特殊处理等。
    -   **详见**: `config/readme.md`

-   **`/modules`**
    -   **职责**: 存放脚本的核心运行时逻辑模块。
    -   **内容**: 采用模块化架构，分为 `/core` (核心翻译引擎)、`/ui` (用户界面优化) 和 `/utils` (通用工具) 三个子目录，分别处理不同的功能。
    -   **详见**: `modules/readme.md`

-   **`/translations`**
    -   **职责**: 存放所有网站的翻译数据。
    -   **内容**:
        -   `index.js`: 作为主翻译映射，导入并注册了所有网站的翻译模块。
        -   语言子目录 (如 `zh-cn/`, `zh-hk/`): 每个子目录包含该语言版本下所有网站的翻译配置文件。
    -   **注意**: 此目录下的文件不应被直接注释或生成 `readme.md`，因为它属于数据层，而非逻辑层。

---

## 构建流程

在构建过程中，`build-project.js` 或 `build-cdn.js` 任务会分别以 `main.js` 或 `main-cdn.js` 为入口点，使用 `esbuild` 工具将所有相关的依赖项打包，并与对应的 `header.txt` 文件合并，最终在 `dist/` 目录下生成可供用户安装的 `.user.js` 文件。